nq.xh=mn.nn();mn.rn(nq.xh,nq.iq,{qn:function(kq){this.jq(kq);this.kq.onComplete=this.dt.ln(this);this.kq.ur=this.et.ln(this);this.kq.sr=this.yq.ln(this);this.kq.timeout=(4957+43);this.frequency=(this.kq.frequency||2);this.ft={} ;this.zt();} ,et:function($t,_t){if(this.kq.ku)this.kq.ku("offline, reconnecting");this.nu();this.qu=setTimeout(this.zt.ln(this),01750);} ,yq:function($t){if(this.kq.ku)this.kq.ku("timeout, reconnecting");this.nu();this.qu=setTimeout(this.zt.ln(this),(938+62));} ,nu:function(){if(this.ft.kq)this.ft.kq.onComplete=undefined;clearTimeout(this.qu);} ,zt:function(){if(this.kq.yh)this.kq.pq=(this.kq.yh)();this.ft=new nq.aq(this.kq.url,this.kq);} ,dt:function(du){try{var iu=nq.rq(du);if(iu){(this.kq.ju||nq.hq)(iu);} else{if(this.kq.ku)this.kq.ku("reconnecting");} } catch(e){} this.qu=setTimeout(this.zt.ln(this),this.frequency*(890+110));} } );var zh={$h:function(link,title,_h,mi,width,height,ni){return'<a href="'+link+'"'+(ni!=null?' class="'+ni+'"':'')+' target="_blank" title="'+title+'" onclick="this.newWindow = window.open(\''+link+'\', \''+_h+'\', \'toolbar=0,scrollbars=0,location=0,status=1,menubar=0,width='+width+',height='+height+',resizable=1\');this.newWindow.focus();this.newWindow.opener=window;return false;">'+mi+'</a>';} ,qi:function(content){return'<table class="inner"><tr>'+content+'</tr></table>';} ,ri:function(si,ti,id,ui,hi,ii,wt,ji){var ki=2;var link=ti+"?thread="+id;var li='<td>';if(hi||ui){li+=zh.$h((ji||!ui)?link:link+"&viewonly=true",localized[hi?0:1],"ImCenter"+id,si,(599+41),0x1e0,null);} else{li+='<a href="#">'+si+'</a>';} li+='</td>';if(hi){li+='<td class="icon">';li+=zh.$h(link,localized[0],"ImCenter"+id,'<img src="'+mh+'/images/tbliclspeak.gif" width="15" height="15" border="0" alt="'+localized[0]+'">',01200,0740,null);li+='</td>';ki++;} if(ui){li+='<td class="icon">';li+=zh.$h(link+"&viewonly=true",localized[1],"ImCenter"+id,'<img src="'+mh+'/images/tbliclread.gif" width="15" height="15" border="0" alt="'+localized[1]+'">',0x280,0740,null);li+='</td>';ki++;} if(wt!=""){li+='</tr><tr><td class="firstmessage" colspan="'+ki+'"><a href="javascript:void(0)" title="'+wt+'" onclick="alert(this.title);return false;">';li+=wt.length>(24+6)?wt.substring(0,0x1e)+'...':wt;li+='</a></td>';} return zh.qi(li);} ,oi:function(id,pi){return'<td class="icon">'+zh.$h(mh+'/operator/ban.php?'+(pi?'id='+pi:'thread='+id),localized[2],"ban"+id,'<img src="'+mh+'/images/ban.gif" width="15" height="15" border="0" alt="'+localized[2]+'">',01320,0x1e0,null)+'</td>';} } ;nq.di=mn.nn();mn.rn(nq.di,nq.iq,{qn:function(kq){this.jq(kq);this.kq.yh=this.yh.ln(this);this.kq.ku=this.ku.ln(this);this.kq.ju=this.ju.ln(this);this.kq.ei=0;this.fi=new Object();this.gi=0;this.t=this.kq.ai;this.bi=new nq.xh(this.kq);} ,yh:function(){return"since="+this.kq.ei+"&status="+this.kq.istatus+(this.kq.showonline?"&showonline=1":"");} ,mu:function(ou){this.kq.status.innerHTML=ou;} ,ku:function(s){this.mu(s);} ,ci:function(uh){var id,vi,wi,ui=false,hi=false,xi=false,ii=null,pi=null;for(var i=0;i<uh.attributes.length;i++){var yi=uh.attributes[i];if(yi.nodeName=="id")id=yi.nodeValue;else if(yi.nodeName=="stateid")vi=yi.nodeValue;else if(yi.nodeName=="state")wi=yi.nodeValue;else if(yi.nodeName=="canopen")hi=true;else if(yi.nodeName=="canview")ui=true;else if(yi.nodeName=="canban")xi=true;else if(yi.nodeName=="ban")ii=yi.nodeValue;else if(yi.nodeName=="banid")pi=yi.nodeValue;} function zi(os,$i,id,_i){var cs=js.ds(id,$i,os);if(cs)cs.innerHTML=_i;} var $i=js.ks("thr"+id,this.t);if(vi=="closed"){if($i){this.t.deleteRow($i.rowIndex);} this.fi[id]=null;return;} var mj=ms.ns(uh,"name");var nj=ms.ns(uh,"addr");var qj=ms.ns(uh,"time");var rj=ms.ns(uh,"agent");var sj=ms.ns(uh,"modified");var wt=ms.ns(uh,"message");var tj='<td>'+ms.ns(uh,"useragent")+'</td>';if(ii!=null){tj='<td>'+ms.ns(uh,"reason")+'</td>';} if(xi){tj+=zh.oi(id,pi);} tj=zh.qi(tj);var uj=js.ks("t"+vi,this.t);var hj=js.ks("t"+vi+"end",this.t);if($i!=null&&($i.rowIndex<=uj.rowIndex||$i.rowIndex>=hj.rowIndex)){this.t.deleteRow($i.rowIndex);this.fi[id]=null;$i=null;} if($i==null){$i=this.t.insertRow(uj.rowIndex+1);$i.className=(ii=="blocked"&&vi!="chat")?"ban":"in"+vi;$i.id="thr"+id;this.fi[id]=new Array(qj,sj,vi);js.insertCell($i,"name","visitor",null,null,zh.ri(mj,this.kq.agentservl,id,ui,hi,ii,wt,vi!='chat'));js.insertCell($i,"contid","visitor","center",null,nj);js.insertCell($i,"state","visitor","center",null,wi);js.insertCell($i,"op","visitor","center",null,rj);js.insertCell($i,"time","visitor","center",null,this.ij(qj));js.insertCell($i,"wait","visitor","center",null,(vi!='chat'?this.ij(sj):'-'));js.insertCell($i,"etc","visitor","center",null,tj);if(vi=='wait'||vi=='prio')return true;} else{this.fi[id]=new Array(qj,sj,vi);$i.className=(ii=="blocked"&&vi!="chat")?"ban":"in"+vi;zi(this.t,$i,"name",zh.ri(mj,this.kq.agentservl,id,ui,hi,ii,wt,vi!='chat'));zi(this.t,$i,"contid",nj);zi(this.t,$i,"state",wi);zi(this.t,$i,"op",rj);zi(this.t,$i,"time",this.ij(qj));zi(this.t,$i,"wait",(vi!='chat'?this.ij(sj):'-'));zi(this.t,$i,"etc",tj);} return false;} ,jj:function(){function kj(t,id){var uj=$(id);var hj=$(id+"end");if(uj==null||hj==null){return false;} return uj.rowIndex+1<hj.rowIndex;} var lj=$("statustd");if(lj){var oj=kj(this.t,"twait")||kj(this.t,"tprio")||kj(this.t,"tchat");lj.innerHTML=oj?"":this.kq.noclients;lj.height=oj?(4+1):(20+10);} } ,ij:function(pj){var dj=Math.floor(((new Date()).getTime()-pj-this.gi)/01750);var ej=Math.floor(dj/(55+5));var fj="";dj=dj%(52+8);if(dj<012)dj="0"+dj;if(ej>=(46+14)){var gj=Math.floor(ej/(40+20));ej=ej%074;if(ej<(6+4))ej="0"+ej;fj=gj+":";} return fj+ej+":"+dj;} ,aj:function(){for(var i in this.fi){if(this.fi[i]!=null){var value=this.fi[i];var $i=js.ks("thr"+i,this.t);if($i!=null){function zi(os,$i,id,_i){var cs=js.ds(id,$i,os);if(cs)cs.innerHTML=_i;} zi(this.t,$i,"time",this.ij(value[0]));zi(this.t,$i,"wait",(value[2]!='chat'?this.ij(value[1]):'-'));} } } } ,bj:function(cj){var vj=false;var wj=ms.is(cj,"time");var xj=ms.is(cj,"revision");if(wj)this.gi=(new Date()).getTime()-wj;if(xj)this.kq.ei=xj;for(var i=0;i<cj.childNodes.length;i++){var uh=cj.childNodes[i];if(uh.tagName=='thread')if(this.ci(uh))vj=true;} this.jj();this.aj();this.mu(this.kq.istatus?"Away":"Up to date");if(vj){ys(mh+'/sounds/new_user.wav');window.focus();if(updaterOptions.showpopup){alert(localized[(4+1)]);} } } ,yj:function(cj){var zj=$('onlineoperators');if(!zj)return;var $j=[];for(var i=0;i<cj.childNodes.length;i++){var uh=cj.childNodes[i];if(uh.tagName!='operator')continue;var name=ms.is(uh,'name');var _j=ms.is(uh,'away')!=null;$j[$j.length]='<img src="'+mh+'/images/op'+(_j?'away':'online')+'.gif" width="12" height="12" border="0" alt="'+localized[1]+'"> '+name;} zj.innerHTML=$j.join(', ');} ,ju:function(cj){if(cj.tagName=='update'){for(var i=0;i<cj.childNodes.length;i++){var uh=cj.childNodes[i];if(uh.tagName=='threads'){this.bj(uh);} else if(uh.tagName=='operators'){this.yj(uh);} } } else if(cj.tagName=='error'){this.mu(ms.ns(cj,"descr"));} else{this.mu("reconnecting");} } } );function mk(){if($("sidebar")&&$("wcontent")&&$("togglemenu")){if($("wcontent").className=="contentnomenu"){$("sidebar").style.display="block";$("wcontent").className="contentinner";$("togglemenu").innerHTML=localized[(1+3)];} else{$("sidebar").style.display="none";$("wcontent").className="contentnomenu";$("togglemenu").innerHTML=localized[3];} } } var mh="";pr.ir({'#togglemenu':function(vh){vh.onclick=function(){mk();} ;} } );hr.ir(window,'onload',function(){mh=updaterOptions.wroot;new nq.di(({ai:$("threadlist"),status:$("connstatus"),istatus:0} ).tn(updaterOptions||{} ));if(!updaterOptions.havemenu){mk();} } );